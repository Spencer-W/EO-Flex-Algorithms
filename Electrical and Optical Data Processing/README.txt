% created by Spencer Ward
% 11/14/2020

This folder contains all of the .m matlab scripts and .mat data files used to produce the figures found in "Electro-optical mechanically flexible coaxial microprobes for minimally invasive interfacing with intrinsic neural circuits".

After downloading this folder, open the .m script and add the path where it is located.
You can then run the program and will prompted for which data run you would like to process.
Runs include 1,5, and 13 for spontaneous recordings and range from 36 to 52 for variations in optical power, stimulation frequency, duty cycle, and probe retraction.
AFter running each section, various pdf files will be generated for the BAKS estimator, optical input, eletrical activity (including spike sorting using PCA), and combined data.

Figure 2 from the manuscript used run13.mat as the data for the spontaneous recording. Run 1 and run 5 were recorded at different depths in the tissue, while run13 was performed at the same location as runs 36-52.

Figure 3 panels were taken from the output of this .m script after processing run47.mat (61uW of optical power).

The .mat files for the concatenated Supplemental figures can be generated by stringing together the base, Laser, tE, and tL data sets for 'run42+41+36+43+44' (for duty cycle), 'run40+36+37+38+39' (for frequency), 'run36+45+46+47+48+49' (for power), and 'run36+51+52' (for probe retraction).

The following is a list of all runs and their parameters:

Run1.mat
Baseline
No optical stimulation
  
Run5.mat
Baseline
No optical stimulation
  
Run13.mat
Baseline
No optical stimulation
  
Run36.mat
20 pules, 20 Hz, 10% duty cycle, 1s on 1s off
DPSS laser power: 4.03

Run37.mat
30 pules, 30 Hz, 10% duty cycle, 1s on 1s off
DPSS laser power: 4.03

Run38.mat
40 pules, 40 Hz, 10% duty cycle, 1s on 1s off
DPSS laser power: 4.03

Run39.mat
50 pules, 50 Hz, 10% duty cycle, 1s on 1s off
DPSS laser power: 4.03

Run40.mat
10 pules, 10 Hz, 10% duty cycle, 1s on 1s off
DPSS laser power: 4.03

Run41.mat
20 pules, 20 Hz, 5% duty cycle, 1s on 1s off
DPSS laser power: 4.03

Run42.mat
20 pules, 20 Hz, 2% duty cycle, 1s on 1s off
DPSS laser power: 4.03

Run43.mat
20 pules, 20 Hz, 15% duty cycle, 1s on 1s off
DPSS laser power: 4.03

Run44.mat
20 pules, 20 Hz, 20% duty cycle, 1s on 1s off
DPSS laser power: 4.03

Run45.mat
20 pules, 20 Hz, 10% duty cycle, 1s on 1s off
DPSS laser power: 3.49

Run46.mat
20 pules, 20 Hz, 10% duty cycle, 1s on 1s off
DPSS laser power: 3.03

Run47.mat
20 pules, 20 Hz, 10% duty cycle, 1s on 1s off
DPSS laser power: 2.49

Run48.mat
20 pules, 20 Hz, 10% duty cycle, 1s on 1s off
DPSS laser power: 2.08

Run49.mat
20 pules, 20 Hz, 10% duty cycle, 1s on 1s off
DPSS laser power: 1.55


RETRACTING PIPETTE TO 162 um DEPTH…
Run50.mat
20 pules, 20 Hz, 10% duty cycle, 1s on 1s off
DPSS laser power: 4.03

RETRACTING PIPETTE JUST OUT OF TISSUE…
Run51.mat
20 pules, 20 Hz, 10% duty cycle, 1s on 1s off
DPSS laser power: 4.03

RETRACTING PIPETTE WAY OUT OF TISSUE (but still in water immersion)…
Run52.mat
20 pules, 20 Hz, 10% duty cycle, 1s on 1s off
DPSS laser power: 4.03

Laser power was calibrated as follows:
DPSS (V)   Optical Power (uW)
	1.55	           6 
	2.08	          29 
	2.49	          61 
	3.03	         152 
	3.49	         189 
	4.03	         208 

